<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steghide Web GUI</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
        }
        .tab-button.active {
            background-color: #3498DB; /* Peter River Blue */
            color: black;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        /* Custom scrollbar for output area */
        .custom-scrollbar::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #2C3E50; /* Dark Blue/Grey */
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #3498DB; /* Peter River Blue */
            border-radius: 10px;
            border: 3px solid #2C3E50;
        }
        .custom-scrollbar::-webkit-scrollbar-corner {
            background: #2C3E50;
        }

        /* Specific colors for Steghide output (adapted from Nmap) */
        .output-green { color: #2ECC71; } /* Emerald Green - for success messages */
        .output-red { color: #E74C3C; }   /* Alizarin Red - for errors/failures */
        .output-blue { color: #3498DB; }  /* Peter River Blue - for informational messages */
        .output-orange { color: #F39C12; } /* Orange - for warnings */
        .output-default { color: #ECF0F1; } /* Light Grey - for general output */
        .highlight { background-color: yellow; color: black; }

        /* Help popup styling */
        .help-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2C3E50; /* Dark Blue/Grey */
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            padding: 1.5rem;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #3498DB; /* Add a border for better visibility */
        }
        .help-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 999;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8); /* Dark modal background */
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #1a202c; /* Modal background */
            margin: auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            border: 1px solid #3498DB; /* Blue border for modal */
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #3498DB;
            margin-bottom: 15px;
        }
        .modal-header h2 {
            @apply text-xl font-semibold text-blue-400; /* Blue modal title */
        }
        .modal-close {
            @apply text-gray-400 hover:text-blue-400 text-2xl font-bold;
            cursor: pointer;
        }
        .modal-body {
            flex-grow: 1;
            overflow-y: auto;
            @apply text-gray-300;
        }
        .modal-footer {
            padding-top: 15px;
            border-top: 1px solid #3498DB;
            margin-top: 15px;
            text-align: right;
        }

        /* Input field styling */
        input[type="text"], input[type="number"], input[type="password"], select, textarea {
            @apply bg-gray-600 text-white rounded-md border border-gray-500 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50 p-2;
        }
        input[type="file"] {
            @apply bg-gray-600 text-white rounded-md border border-gray-500 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50 p-2;
            cursor: pointer;
        }
        input[type="checkbox"] {
            @apply form-checkbox h-5 w-5 text-blue-600 rounded bg-gray-600 border-gray-500;
        }

        /* Button styling */
        .btn-primary {
            @apply px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 flex items-center justify-center transition-colors duration-200;
        }
        .btn-secondary {
            @apply px-4 py-2 bg-gray-700 text-gray-200 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 flex items-center justify-center transition-colors duration-200;
        }
        .btn-success {
            @apply px-6 py-3 bg-green-600 text-white rounded-lg text-lg font-semibold hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center transition-colors duration-200 transform hover:scale-105;
        }
        .btn-danger {
            @apply px-6 py-3 bg-red-600 text-white rounded-lg text-lg font-semibold hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 flex items-center transition-colors duration-200 transform hover:scale-105;
        }
        .btn-info {
            @apply px-6 py-3 bg-purple-600 text-white rounded-lg text-lg font-semibold hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 flex items-center transition-colors duration-200 transform hover:scale-105;
        }
    </style>
</head>
<body class="p-4 min-h-screen flex flex-col items-center">
    <div class="bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-6xl mb-6">
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-3xl font-bold text-blue-400">Steghide Web GUI</h1>
            <div class="flex space-x-2">
                <button id="install_steghide_linux_button" class="btn-primary">
                    <i data-lucide="download" class="w-5 h-5 mr-2"></i> Install Steghide (Linux)
                </button>
                <button id="install_steghide_termux_button" class="btn-primary">
                    <i data-lucide="download" class="w-5 h-5 mr-2"></i> Install Steghide (Termux)
                </button>
                <button id="install_steghide_windows_button" class="btn-primary">
                    <i data-lucide="download" class="w-5 h-5 mr-2"></i> Install Steghide (Windows)
                </button>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="flex flex-wrap justify-center bg-gray-700 rounded-t-lg p-2 mb-4">
            <button class="tab-button px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 hover:bg-blue-600 active" data-tab="embed">Embed Data</button>
            <button class="tab-button px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 hover:bg-blue-600" data-tab="extract">Extract Data</button>
            <button class="tab-button px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 hover:bg-blue-600" data-tab="info">Get Info</button>
            <button class="tab-button px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 hover:bg-blue-600" data-tab="examples">Examples</button>
        </div>

        <!-- Tab Content -->
        <div id="tab-content-container" class="bg-gray-700 p-4 rounded-b-lg mb-4 max-h-[500px] overflow-y-auto custom-scrollbar">
            <!-- Embed Data Tab -->
            <div id="embed" class="tab-content active">
                <h2 class="text-xl font-semibold text-blue-300 mb-4">Embed Data Options</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex items-center">
                        <label for="embed_file_input" class="w-48 text-right pr-4">File to Embed (-ef):</label>
                        <input type="file" id="embed_file_input" class="flex-1" onchange="uploadFile('embed_file_input', 'embed_file_path_entry');">
                        <input type="hidden" id="embed_file_path_entry" name="embed_file_path_entry">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The file you want to hide (e.g., secret.txt, document.pdf).')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="cover_file_input" class="w-48 text-right pr-4">Cover File (-cf):</label>
                        <input type="file" id="cover_file_input" class="flex-1" onchange="uploadFile('cover_file_input', 'cover_file_path_entry');">
                        <input type="hidden" id="cover_file_path_entry" name="cover_file_path_entry">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The image or audio file that will contain the hidden data (e.g., image.jpg, song.wav).')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="output_file_path_entry" class="w-48 text-right pr-4">Output Stego File (-sf):</label>
                        <input type="text" id="output_file_path_entry" name="output_file_path_entry" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="generateCommand()">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The name for the new file containing the hidden data. If left blank, it will overwrite the cover file.')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="password_entry" class="w-48 text-right pr-4">Passphrase (-p):</label>
                        <input type="password" id="password_entry" name="password_entry" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="generateCommand()">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The password to encrypt and decrypt the embedded data. Optional, but highly recommended.')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="encrypt_algo_dropdown" class="w-48 text-right pr-4">Encryption Algorithm (-e):</label>
                        <select id="encrypt_algo_dropdown" name="encrypt_algo_dropdown" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onchange="generateCommand()">
                            <option value="">(Default: rijndael-128)</option>
                            <option value="blowfish">blowfish</option>
                            <option value="cast128">cast128</option>
                            <option value="des">des</option>
                            <option value="rijndael-128">rijndael-128 (AES-128)</option>
                            <option value="rijndael-192">rijndael-192 (AES-192)</option>
                            <option value="rijndael-256">rijndael-256 (AES-256)</option>
                            <option value="twofish">twofish</option>
                            <option value="xtea">xtea</option>
                        </select>
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('Choose the encryption algorithm for the embedded data.')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="compression_level_entry" class="w-48 text-right pr-4">Compression Level (-Z):</label>
                        <input type="number" id="compression_level_entry" name="compression_level_entry" min="0" max="9" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="generateCommand()">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('Set compression level for embedded data (0=no compression, 9=max compression).')">?</button>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="no_compression_var" name="no_compression_var" class="form-checkbox h-5 w-5 text-blue-600 rounded bg-gray-600 border-gray-500" onchange="generateCommand()">
                        <label for="no_compression_var" class="ml-2">No Compression (-nc)</label>
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('Do not compress the embedded data.')">?</button>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="no_password_var" name="no_password_var" class="form-checkbox h-5 w-5 text-blue-600 rounded bg-gray-600 border-gray-500" onchange="generateCommand()">
                        <label for="no_password_var" class="ml-2">No Passphrase (-np)</label>
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('Embed data without a passphrase. Not recommended for sensitive data.')">?</button>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="force_overwrite_var" name="force_overwrite_var" class="form-checkbox h-5 w-5 text-blue-600 rounded bg-gray-600 border-gray-500" onchange="generateCommand()">
                        <label for="force_overwrite_var" class="ml-2">Force Overwrite (-f)</label>
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('Force overwriting of existing files without prompting.')">?</button>
                    </div>
                </div>
            </div>

            <!-- Extract Data Tab -->
            <div id="extract" class="tab-content">
                <h2 class="text-xl font-semibold text-blue-300 mb-4">Extract Data Options</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex items-center">
                        <label for="extract_cover_file_input" class="w-48 text-right pr-4">Stego File (-sf):</label>
                        <input type="file" id="extract_cover_file_input" class="flex-1" onchange="uploadFile('extract_cover_file_input', 'extract_cover_file_path_entry');">
                        <input type="hidden" id="extract_cover_file_path_entry" name="extract_cover_file_path_entry">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The file containing the hidden data (e.g., output_image.jpg).')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="extract_output_file_path_entry" class="w-48 text-right pr-4">Output Extracted File (-xf):</label>
                        <input type="text" id="extract_output_file_path_entry" name="extract_output_file_path_entry" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="generateCommand()">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The name for the extracted file. If left blank, Steghide will use the original filename.')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="extract_password_entry" class="w-48 text-right pr-4">Passphrase (-p):</label>
                        <input type="password" id="extract_password_entry" name="extract_password_entry" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="generateCommand()">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The passphrase used to embed the data.')">?</button>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="extract_force_overwrite_var" name="extract_force_overwrite_var" class="form-checkbox h-5 w-5 text-blue-600 rounded bg-gray-600 border-gray-500" onchange="generateCommand()">
                        <label for="extract_force_overwrite_var" class="ml-2">Force Overwrite (-f)</label>
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('Force overwriting of existing files without prompting.')">?</button>
                    </div>
                </div>
            </div>

            <!-- Get Info Tab -->
            <div id="info" class="tab-content">
                <h2 class="text-xl font-semibold text-blue-300 mb-4">Get Info Options</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex items-center">
                        <label for="info_file_input" class="w-48 text-right pr-4">Stego File (-sf):</label>
                        <input type="file" id="info_file_input" class="flex-1" onchange="uploadFile('info_file_input', 'info_file_path_entry');">
                        <input type="hidden" id="info_file_path_entry" name="info_file_path_entry">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The file to get information about (e.g., output_image.jpg).')">?</button>
                    </div>
                    <div class="flex items-center">
                        <label for="info_password_entry" class="w-48 text-right pr-4">Passphrase (-p):</label>
                        <input type="password" id="info_password_entry" name="info_password_entry" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="generateCommand()">
                        <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded" onclick="showHelp('The passphrase used to embed the data (if any).')">?</button>
                    </div>
                </div>
            </div>

            <!-- Examples Tab -->
            <div id="examples" class="tab-content">
                <h2 class="text-xl font-semibold text-blue-300 mb-4">Examples</h2>
                <div class="mb-4 flex items-center">
                    <label for="example_search_entry" class="w-32 text-right pr-4">Search Examples:</label>
                    <input type="text" id="example_search_entry" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="filterExamples()">
                    <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded" onclick="clearExampleSearch()">Clear Search</button>
                </div>
                <div id="examples_list" class="grid grid-cols-1 gap-4">
                    <!-- Examples will be loaded here by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Generated Command -->
        <div class="bg-gray-700 p-4 rounded-lg shadow-md mb-4">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">Generated Steghide Command</h2>
            <textarea id="command_text" class="w-full h-24 p-2 rounded bg-gray-900 text-blue-400 font-mono text-sm resize-none custom-scrollbar" readonly>steghide</textarea>
            <div class="flex justify-end mt-2 space-x-2">
                <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md transition-colors duration-200" onclick="copyCommand()">Copy Command</button>
                <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md transition-colors duration-200" onclick="generateCommand()">Generate Command</button>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-center space-x-4 mb-4">
            <button id="run_steghide_button" class="btn-success">
                <i data-lucide="play" class="w-6 h-6 mr-2"></i> Run Steghide
            </button>
            <button class="btn-danger" onclick="clearOutput()">
                <i data-lucide="trash-2" class="w-6 h-6 mr-2"></i> Clear Output
            </button>
            <button id="download_extracted_file_button" class="btn-info" style="display: none;">
                <i data-lucide="download" class="w-6 h-6 mr-2"></i> Download Extracted File
            </button>
        </div>

        <!-- Status Bar -->
        <div id="status_bar" class="bg-gray-900 text-white text-sm p-2 rounded-md mb-4 text-center">Ready</div>

        <!-- Steghide Output -->
        <div class="bg-gray-700 p-4 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">Steghide Output</h2>
            <div class="flex items-center mb-2">
                <label for="search_entry" class="pr-2">Search:</label>
                <input type="text" id="search_entry" class="flex-1 p-2 rounded bg-gray-600 text-white border border-gray-500" onkeyup="searchOutput()">
                <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded" onclick="searchOutput()">Search</button>
                <button class="ml-2 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded" onclick="clearSearchHighlight()">Clear Search</button>
            </div>
            <pre id="output_text" class="w-full h-96 p-2 rounded bg-gray-900 text-gray-200 font-mono text-sm overflow-auto custom-scrollbar"></pre>
        </div>
    </div>

    <!-- Footer -->
    <div class="text-gray-500 text-sm mt-4">
        Created by khedr0x00
    </div>

    <!-- Global Message/Alert Modal -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="messageModalTitle">Alert</h2>
                <span class="modal-close" onclick="closeMessageModal()">&times;</span>
            </div>
            <div class="modal-body" id="messageModalBody"></div>
            <div class="modal-footer">
                <button onclick="closeMessageModal()" class="btn-primary">OK</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal for Linux/Termux Installation -->
    <div id="installConfirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="installConfirmModalTitle">Confirm Installation</h2>
                <span class="modal-close" onclick="closeInstallConfirmModal()">&times;</span>
            </div>
            <div class="modal-body" id="installConfirmModalBody"></div>
            <div class="modal-footer flex justify-end space-x-4">
                <button onclick="closeInstallConfirmModal()" class="btn-secondary">Cancel</button>
                <button id="confirmInstallButton" class="btn-success">Install Now</button>
            </div>
        </div>
    </div>

    <!-- Example Output Modal -->
    <div id="exampleOutputModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="exampleOutputModalTitle">Example Output</h2>
                <span class="modal-close" onclick="closeExampleOutputModal()">&times;</span>
            </div>
            <div class="modal-body">
                <pre id="exampleOutputModalText" class="w-full h-auto p-2 rounded bg-gray-900 text-gray-200 font-mono text-sm overflow-auto custom-scrollbar"></pre>
            </div>
            <div class="modal-footer">
                <button onclick="closeExampleOutputModal()" class="btn-primary">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Global variable to store examples
        let allExamples = [];
        let currentScanId = null;
        let pollInterval = null;
        let searchStartIndex = 0; // For incremental search in output
        let currentOutputBuffer = ""; // Buffer to accumulate real-time output
        let extractedFileName = null; // To store the name of the extracted file for download

        // Function to show/hide tabs
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            document.querySelector(`.tab-button[data-tab="${tabId}"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
            generateCommand(); // Regenerate command on tab change
        }

        // Event listeners for tab buttons
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                showTab(button.dataset.tab);
            });
        });

        // --- Helper for showing custom modals ---
        function showMessageModal(title, message, isHtml = false) {
            document.getElementById('messageModalTitle').innerText = title;
            const messageBody = document.getElementById('messageModalBody');
            if (isHtml) {
                messageBody.innerHTML = message;
            } else {
                messageBody.innerText = message;
            }
            document.getElementById('messageModal').style.display = 'flex';
        }

        function closeMessageModal() {
            document.getElementById('messageModal').style.display = 'none';
        }

        function showInstallConfirmModal(title, message, onConfirm) {
            document.getElementById('installConfirmModalTitle').innerText = title;
            document.getElementById('installConfirmModalBody').innerHTML = message;
            const confirmButton = document.getElementById('confirmInstallButton');
            confirmButton.onclick = () => {
                closeInstallConfirmModal();
                onConfirm();
            };
            document.getElementById('installConfirmModal').style.display = 'flex';
        }

        function closeInstallConfirmModal() {
            document.getElementById('installConfirmModal').style.display = 'none';
        }

        function showExampleOutputModal(title, output) {
            document.getElementById('exampleOutputModalTitle').innerText = title;
            const outputPre = document.getElementById('exampleOutputModalText');
            outputPre.innerHTML = ''; // Clear previous content

            // Apply coloring based on Steghide-like output
            insertColoredText(outputPre, output);
            document.getElementById('exampleOutputModal').style.display = 'flex';
        }

        function closeExampleOutputModal() {
            document.getElementById('exampleOutputModal').style.display = 'none';
        }

        // Function to upload files
        async function uploadFile(fileInputId, hiddenPathId) {
            const fileInput = document.getElementById(fileInputId);
            const hiddenPath = document.getElementById(hiddenPathId);
            const file = fileInput.files[0];

            if (!file) {
                hiddenPath.value = ''; // Clear hidden path if no file selected
                generateCommand();
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            showStatus(`Uploading ${file.name}...`, 'blue');
            try {
                const response = await fetch('/upload_file', {
                    method: 'POST',
                    body: formData,
                });
                const data = await response.json();
                if (data.status === 'success') {
                    hiddenPath.value = data.filepath; // Store the filename (path within UPLOAD_FOLDER)
                    showStatus(`${file.name} uploaded successfully.`, 'green');
                } else {
                    showMessageModal('Upload Error', `Failed to upload ${file.name}: ${data.message}`);
                    showStatus(`Failed to upload ${file.name}.`, 'red');
                    hiddenPath.value = ''; // Clear hidden path on error
                }
            } catch (error) {
                console.error('Error uploading file:', error);
                showMessageModal('Upload Error', `An error occurred during upload: ${error.message}`);
                showStatus(`Error uploading ${file.name}.`, 'red');
                hiddenPath.value = ''; // Clear hidden path on error
            }
            generateCommand(); // Regenerate command after file path is set
        }

        // Function to collect form data
        function getFormData() {
            const formData = {};
            const activeTab = document.querySelector('.tab-button.active').dataset.tab;
            formData['action_type'] = activeTab; // Add the active tab as action_type

            document.querySelectorAll(`#${activeTab} input, #${activeTab} select, #${activeTab} textarea`).forEach(element => {
                if (element.type === 'checkbox') {
                    formData[element.id] = element.checked;
                } else if (element.type === 'number') {
                    formData[element.id] = element.value ? parseFloat(element.value) : '';
                } else if (element.type === 'file') {
                    // File inputs are handled by uploadFile, their actual path is in hidden inputs
                    // We get the value from the corresponding hidden input
                    const hiddenInputId = element.id.replace('_input', '_path_entry');
                    const hiddenInput = document.getElementById(hiddenInputId);
                    formData[hiddenInputId] = hiddenInput ? hiddenInput.value : '';
                }
                else {
                    formData[element.id] = element.value;
                }
            });
            return formData;
        }

        // Function to generate Steghide command
        async function generateCommand() {
            const formData = getFormData();
            try {
                const response = await fetch('/generate_command', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
                });
                const data = await response.json();
                document.getElementById('command_text').value = data.command;
            } catch (error) {
                console.error('Error generating command:', error);
                document.getElementById('command_text').value = 'Error generating command.';
            }
        }

        // Function to copy command to clipboard
        function copyCommand() {
            const commandText = document.getElementById('command_text');
            commandText.select();
            document.execCommand('copy');
            showMessageModal('Command Copied', 'The command has been copied to your clipboard!');
        }

        // Function to run Steghide
        async function runSteghide() {
            if (currentScanId) {
                showMessageModal('Steghide Running', 'Steghide is already running. Please wait for it to finish.');
                return;
            }

            const command = document.getElementById('command_text').value;
            if (!command || command.trim() === 'steghide') { // Check if command is just 'steghide' or empty
                showMessageModal('Error', 'Please generate a valid Steghide command first.');
                return;
            }

            // Disable run button and clear output
            document.getElementById('run_steghide_button').disabled = true;
            document.getElementById('download_extracted_file_button').style.display = 'none'; // Hide download button
            document.getElementById('output_text').innerHTML = '';
            currentOutputBuffer = "";
            clearSearchHighlight();
            showStatus('Starting Steghide operation...', 'blue');

            try {
                const response = await fetch('/run_steghide', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ command: command }),
                });
                const data = await response.json();
                if (data.status === 'error') {
                    showMessageModal('Error', data.message);
                    showStatus(`Error: ${data.message}`, 'red');
                    document.getElementById('run_steghide_button').disabled = false;
                } else {
                    currentScanId = data.scan_id;
                    showStatus(`Steghide operation started (ID: ${currentScanId}). Fetching output...`, 'blue');
                    // Start polling for output
                    pollInterval = setInterval(pollOutput, 500); // Poll every 500ms
                }
            } catch (error) {
                console.error('Error starting Steghide:', error);
                showMessageModal('Error', 'An error occurred while starting Steghide.');
                showStatus('An error occurred while starting Steghide.', 'red');
                document.getElementById('run_steghide_button').disabled = false;
            }
        }

        // Polling for Steghide output
        async function pollOutput() {
            if (!currentScanId) {
                clearInterval(pollInterval);
                pollInterval = null;
                return;
            }

            try {
                const response = await fetch(`/get_command_output/${currentScanId}`);
                const data = await response.json();
                const outputTextElement = document.getElementById('output_text');
                
                if (data.output) {
                    // Only append new output to the buffer
                    const newOutputSegment = data.output.substring(currentOutputBuffer.length);
                    currentOutputBuffer += newOutputSegment;
                    insertColoredText(outputTextElement, currentOutputBuffer);
                }

                if (data.status === 'running') {
                    showStatus('Steghide is running...', 'blue');
                } else if (data.status === 'completed' || data.status === 'success' || data.status === 'error') {
                    clearInterval(pollInterval);
                    pollInterval = null;
                    currentScanId = null;
                    currentOutputBuffer = data.output; // Get final complete output
                    insertColoredText(outputTextElement, currentOutputBuffer);
                    
                    if (data.status === 'completed' || data.status === 'success') {
                        showStatus('Steghide operation completed successfully.', 'green');
                        // Check if it was an extraction and show download button
                        const activeTab = document.querySelector('.tab-button.active').dataset.tab;
                        if (activeTab === 'extract') {
                            const extractedFileNameInput = document.getElementById('extract_output_file_path_entry');
                            if (extractedFileNameInput && extractedFileNameInput.value) {
                                extractedFileName = extractedFileNameInput.value;
                                document.getElementById('download_extracted_file_button').style.display = 'inline-flex';
                            } else {
                                // If output file path was not specified, steghide uses original filename.
                                // This is tricky to get from output without parsing. For now, rely on user input.
                                showMessageModal('Extraction Complete', 'Data extracted. If you did not specify an output filename, Steghide used the original filename of the embedded file. You might need to check the server\'s `uploads_steghide` folder.');
                            }
                        }
                    } else {
                        showStatus(`Operation failed: ${data.message || 'Unknown error'}`, 'red');
                        showMessageModal('Operation Error', data.message || 'An unknown error occurred during the Steghide operation.');
                    }
                    document.getElementById('run_steghide_button').disabled = false;
                    // Re-enable install buttons if they were disabled for installation
                    document.getElementById('install_steghide_linux_button').disabled = false;
                    document.getElementById('install_steghide_termux_button').disabled = false;
                    document.getElementById('install_steghide_windows_button').disabled = false;
                } else if (data.status === 'not_found') {
                    clearInterval(pollInterval);
                    pollInterval = null;
                    currentScanId = null;
                    showStatus(`Operation failed: ${data.message || 'Command ID not found or expired.'}`, 'red');
                    showMessageModal('Operation Error', data.message || 'Command ID not found or expired.');
                    document.getElementById('run_steghide_button').disabled = false;
                    // Re-enable install buttons if they were disabled for installation
                    document.getElementById('install_steghide_linux_button').disabled = false;
                    document.getElementById('install_steghide_termux_button').disabled = false;
                    document.getElementById('install_steghide_windows_button').disabled = false;
                }
            } catch (error) {
                console.error('Error polling output:', error);
                showMessageModal('Polling Error', 'An error occurred while fetching output.');
                showStatus('An error occurred while fetching output.', 'red');
                clearInterval(pollInterval);
                pollInterval = null;
                currentScanId = null;
                document.getElementById('run_steghide_button').disabled = false;
                // Re-enable install buttons if they were disabled for installation
                document.getElementById('install_steghide_linux_button').disabled = false;
                document.getElementById('install_steghide_termux_button').disabled = false;
                document.getElementById('install_steghide_windows_button').disabled = false;
            }
        }

        // Helper to insert colored text based on Steghide output patterns
        function insertColoredText(element, text) {
            element.innerHTML = ''; // Clear current content to re-insert with spans
            const lines = text.split('\n');
            const fragment = document.createDocumentFragment();

            lines.forEach(line => {
                const span = document.createElement('span');
                let className = 'output-default';

                if (line.toLowerCase().includes('done') || line.toLowerCase().includes('wrote extracted data')) {
                    className = 'output-green';
                } else if (line.toLowerCase().includes('error') || line.toLowerCase().includes('failed') || line.toLowerCase().includes('could not extract')) {
                    className = 'output-red';
                } else if (line.toLowerCase().includes('embedding') || line.toLowerCase().includes('extracting') || line.toLowerCase().includes('info on') || line.toLowerCase().includes('rebinding data') || line.toLowerCase().includes('detected')) {
                    className = 'output-blue';
                } else if (line.toLowerCase().includes('warning')) {
                    className = 'output-orange';
                }
                
                span.className = className;
                span.textContent = line + '\n'; // Add newline back for pre tag
                fragment.appendChild(span);
            });
            element.appendChild(fragment);
            element.scrollTop = element.scrollHeight; // Scroll to bottom
        }

        // Function to clear output
        function clearOutput() {
            document.getElementById('output_text').innerHTML = '';
            currentOutputBuffer = "";
            showStatus('Ready');
            clearSearchHighlight();
            document.getElementById('download_extracted_file_button').style.display = 'none'; // Hide download button
            extractedFileName = null;
            if (currentScanId) {
                clearInterval(pollInterval);
                pollInterval = null;
                currentScanId = null;
            }
        }

        // Function to download extracted file
        function downloadExtractedFile() {
            if (extractedFileName) {
                window.open(`/download_output/${extractedFileName}`, '_blank');
            } else {
                showMessageModal('Download Error', 'No file available for download. Please perform an extraction first.');
            }
        }

        // Function to update status bar
        function showStatus(message, color = 'white') {
            const statusBar = document.getElementById('status_bar');
            statusBar.textContent = message;
            statusBar.style.color = color;
        }

        // Function to search output
        function searchOutput() {
            const searchTerm = document.getElementById('search_entry').value.trim().toLowerCase();
            const outputTextElement = document.getElementById('output_text');
            const fullText = outputTextElement.textContent; // Use textContent to get plain text

            clearSearchHighlight(); // Clear existing highlights first

            if (!searchTerm) {
                searchStartIndex = 0;
                return;
            }

            let found = false;
            let newContent = '';
            let lastIndex = 0;

            const regex = new RegExp(searchTerm, 'gi'); // 'gi' for global and case-insensitive

            let match;
            while ((match = regex.exec(fullText)) !== null) {
                found = true;
                const index = match.index;
                const matchedText = match[0];

                // Append content before the match
                newContent += escapeHtml(fullText.substring(lastIndex, index));
                // Append the highlighted match
                newContent += `<mark class="highlight">${escapeHtml(matchedText)}</mark>`;
                lastIndex = index + matchedText.length;
            }
            newContent += escapeHtml(fullText.substring(lastIndex)); // Append remaining content

            outputTextElement.innerHTML = newContent;

            if (!found) {
                showMessageModal('Search', `No occurrences of '${searchTerm}' found.`);
            } else {
                // Scroll to the first highlighted element
                const firstHighlight = outputTextElement.querySelector('mark.highlight');
                if (firstHighlight) {
                    firstHighlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }

        // Function to clear search highlight
        function clearSearchHighlight() {
            const outputTextElement = document.getElementById('output_text');
            const currentContent = outputTextElement.textContent; // Get plain text content
            outputTextElement.innerHTML = ''; // Clear existing content
            insertColoredText(outputTextElement, currentContent); // Re-insert without highlights
            searchStartIndex = 0;
        }

        // Function to show help popup
        function showHelp(helpText) {
            const overlay = document.createElement('div');
            overlay.className = 'help-popup-overlay';
            overlay.onclick = () => {
                document.body.removeChild(overlay);
                document.body.removeChild(popup);
            };
            document.body.appendChild(overlay);

            const popup = document.createElement('div');
            popup.className = 'help-popup';
            popup.innerHTML = `
                <h3 class="text-xl font-bold text-blue-300 mb-4">Help</h3>
                <div class="flex-grow overflow-y-auto custom-scrollbar p-2 bg-gray-600 rounded text-gray-200 text-sm mb-4">
                    ${helpText.replace(/\n/g, '<br>')}
                </div>
                <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md self-center" onclick="this.parentNode.parentNode.removeChild(this.parentNode); document.body.removeChild(document.querySelector('.help-popup-overlay'));">Close</button>
            `;
            document.body.appendChild(popup);
        }

        // --- Examples Tab Functions ---
        async function loadExamples() {
            try {
                // Fetch examples from the backend
                const response = await fetch('/get_examples');
                if (response.ok) {
                    allExamples = await response.json();
                } else {
                    console.warn("Could not fetch examples from backend, using hardcoded examples.");
                    // Fallback to hardcoded examples if backend fails
                    allExamples = [
                        {
                            name: "Embed Text File (JPEG)",
                            description: "Embeds a text file into a JPEG image with a password.",
                            options: {
                                embed_file_path_entry: "secret.txt",
                                cover_file_path_entry: "image.jpg",
                                output_file_path_entry: "output_image.jpg",
                                password_entry: "mysecretpassword",
                                encrypt_algo_dropdown: "rijndael-256"
                            },
                            example_output: "embedding \"secret.txt\" in \"image.jpg\"...\nEnter passphrase: \nrebinding data...\ndone"
                        },
                        {
                            name: "Extract Data (JPEG)",
                            description: "Extracts embedded data from a Steghide-modified JPEG image.",
                            options: {
                                extract_cover_file_path_entry: "output_image.jpg",
                                extract_output_file_path_entry: "extracted_secret.txt",
                                extract_password_entry: "mysecretpassword"
                            },
                            example_output: "extracting data from \"output_image.jpg\"...\nEnter passphrase: \nwrote extracted data to \"extracted_secret.txt\"."
                        },
                        {
                            name: "Get Info on Cover File",
                            description: "Displays information about a Steghide-modified file.",
                            options: {
                                info_file_path_entry: "output_image.jpg",
                                info_password_entry: "mysecretpassword"
                            },
                            example_output: "output_image.jpg:\n  format: jpeg\n  capacity: 10.5 KB\n  embedded file: secret.txt\n    size: 2.1 KB\n    encrypted: yes\n    compression: 6"
                        }
                    ];
                }
                filterExamples(); // Display all examples initially
            } catch (error) {
                console.error('Error loading examples:', error);
                showStatus('Error loading examples. Using hardcoded examples.', 'red');
                allExamples = [
                    {
                        name: "Embed Text File (JPEG)",
                        description: "Embeds a text file into a JPEG image with a password.",
                        options: {
                            embed_file_path_entry: "secret.txt",
                            cover_file_path_entry: "image.jpg",
                            output_file_path_entry: "output_image.jpg",
                            password_entry: "mysecretpassword",
                            encrypt_algo_dropdown: "rijndael-256"
                        },
                        example_output: "embedding \"secret.txt\" in \"image.jpg\"...\nEnter passphrase: \nrebinding data...\ndone"
                    },
                    {
                        name: "Extract Data (JPEG)",
                        description: "Extracts embedded data from a Steghide-modified JPEG image.",
                        options: {
                            extract_cover_file_path_entry: "output_image.jpg",
                            extract_output_file_path_entry: "extracted_secret.txt",
                            extract_password_entry: "mysecretpassword"
                        },
                        example_output: "extracting data from \"output_image.jpg\"...\nEnter passphrase: \nwrote extracted data to \"extracted_secret.txt\"."
                    },
                    {
                        name: "Get Info on Cover File",
                        description: "Displays information about a Steghide-modified file.",
                        options: {
                            info_file_path_entry: "output_image.jpg",
                            info_password_entry: "mysecretpassword"
                        },
                        example_output: "output_image.jpg:\n  format: jpeg\n  capacity: 10.5 KB\n  embedded file: secret.txt\n    size: 2.1 KB\n    encrypted: yes\n    compression: 6"
                    }
                ];
                filterExamples();
            }
        }

        function filterExamples() {
            const searchQuery = document.getElementById('example_search_entry').value.toLowerCase();
            const examplesList = document.getElementById('examples_list');
            examplesList.innerHTML = ''; // Clear current list

            allExamples.forEach(example => {
                if (example.name.toLowerCase().includes(searchQuery) || example.description.toLowerCase().includes(searchQuery)) {
                    const exampleDiv = document.createElement('div');
                    exampleDiv.className = 'bg-gray-800 p-4 rounded-lg shadow-md flex flex-col md:flex-row justify-between items-start md:items-center';
                    exampleDiv.innerHTML = `
                        <div>
                            <h3 class="text-lg font-semibold text-blue-300">${escapeHtml(example.name)}</h3>
                            <p class="text-sm text-gray-400 mb-2 md:mb-0">${escapeHtml(example.description)}</p>
                        </div>
                        <div class="flex mt-2 md:mt-0 space-x-2">
                            <button class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-md text-sm" onclick="loadExampleOptions(${escapeHtml(JSON.stringify(example.options))}, '${escapeHtml(getTabFromOptions(example.options))}')">Select</button>
                            <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1 rounded-md text-sm" onclick="showExampleOutputModal('${escapeHtml(example.name)} Output', ${escapeHtml(JSON.stringify(example.example_output))})">Output</button>
                        </div>
                    `;
                    examplesList.appendChild(exampleDiv);
                }
            });
            lucide.createIcons(); // Re-render Lucide icons for new elements
        }

        function clearExampleSearch() {
            document.getElementById('example_search_entry').value = '';
            filterExamples();
        }

        function getTabFromOptions(options) {
            if (options.embed_file_path_entry || options.cover_file_path_entry) return 'embed';
            if (options.extract_cover_file_path_entry) return 'extract';
            if (options.info_file_path_entry) return 'info';
            return 'embed'; // Default tab
        }

        function loadExampleOptions(options, tabToLoad) {
            clearAllInputs(); // Clear all inputs first

            // Populate form fields with example options
            for (const key in options) {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = options[key];
                    } else if (element.tagName === 'TEXTAREA' || element.type === 'password' || element.type === 'text' || element.type === 'number' || element.tagName === 'SELECT') {
                        element.value = options[key];
                    }
                    // For file inputs, we just set the hidden path entry, as we don't have the actual file to re-upload
                    if (key.endsWith('_path_entry')) {
                        const fileInput = document.getElementById(key.replace('_path_entry', '_input'));
                        if (fileInput) {
                            // Clear the file input display
                            fileInput.value = '';
                        }
                    }
                }
            }
            generateCommand(); // Re-generate command after loading
            showMessageModal('Example Loaded', 'Example options have been loaded. Check other tabs and the generated command.');
            showTab(tabToLoad); // Switch to the relevant tab
        }

        // Helper to escape HTML for safe display
        function escapeHtml(text) {
            if (typeof text !== 'string') {
                text = String(text);
            }
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function(m) { return map[m]; });
        }

        // Helper to unescape HTML entities
        function unescapeHtml(html) {
            const doc = new DOMParser().parseFromString(html, 'text/html');
            return doc.documentElement.textContent;
        }

        function clearAllInputs() {
            // Clear text, number, password, and hidden inputs
            document.querySelectorAll('#tab-content-container input[type="text"], #tab-content-container input[type="number"], #tab-content-container input[type="password"], #tab-content-container input[type="hidden"], #tab-content-container textarea').forEach(element => {
                element.value = '';
            });
            // Clear file inputs
            document.querySelectorAll('#tab-content-container input[type="file"]').forEach(element => {
                element.value = ''; // This clears the selected file display
            });
            // Uncheck all checkboxes
            document.querySelectorAll('#tab-content-container input[type="checkbox"]').forEach(element => {
                element.checked = false;
            });
            // Reset all select dropdowns to their first option or empty value
            document.querySelectorAll('#tab-content-container select').forEach(element => {
                element.value = ''; 
                // For encryption algorithm, set back to default if it exists
                if (element.id === 'encrypt_algo_dropdown') {
                    element.value = 'rijndael-128'; // Default for Steghide
                }
            });
            generateCommand(); // Update command after clearing
        }

        // Function to handle Steghide installation
        async function handleSteghideInstallation(platformType) {
            const linuxButton = document.getElementById('install_steghide_linux_button');
            const termuxButton = document.getElementById('install_steghide_termux_button');
            const windowsButton = document.getElementById('install_steghide_windows_button');

            // Disable all install buttons during an installation attempt
            linuxButton.disabled = true;
            termuxButton.disabled = true;
            windowsButton.disabled = true;

            showStatus('Checking system and preparing for installation...', 'blue');
            document.getElementById('output_text').innerHTML = ''; // Clear output area
            currentOutputBuffer = ""; // Clear output buffer for installation logs

            if (platformType === 'linux' || platformType === 'termux') {
                const osName = platformType === 'termux' ? "Termux" : "Linux";
                showInstallConfirmModal(
                    'Install Steghide',
                    `Your operating system is <strong>${osName}</strong>. Do you want to install Steghide now? This will require superuser privileges and might ask for your password in the server console.`,
                    async () => {
                        // This function will be called if the user confirms
                        showStatus(`Installing Steghide on ${osName}...`, 'blue');
                        try {
                            const response = await fetch('/install_steghide', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ platform: platformType }) // Pass platform type to backend
                            });
                            const data = await response.json();

                            if (data.status === 'error') {
                                showStatus(`Steghide installation failed: ${data.message}`, 'red');
                                showMessageModal('Steghide Installation Failed', `Failed to install/update Steghide: ${data.message}<br><br>Output:<pre>${escapeHtml(data.output)}</pre>`, true);
                                insertColoredText(document.getElementById('output_text'), data.output);
                                // Re-enable buttons on error
                                linuxButton.disabled = false;
                                termuxButton.disabled = false;
                                windowsButton.disabled = false;
                            } else { // status is 'running' for real-time output
                                currentScanId = data.scan_id; // Use the scan_id returned by the backend
                                showStatus(`Steghide installation started (ID: ${currentScanId}). Fetching output...`, 'blue');
                                pollInterval = setInterval(pollOutput, 500); // Start polling for output
                            }
                        } catch (error) {
                            console.error('Error during Steghide installation fetch:', error);
                            showStatus('An error occurred during installation.', 'red');
                            showMessageModal('Steghide Installation Error', `An error occurred while trying to install Steghide: ${error.message}. Check server logs for more details.`);
                            // Re-enable buttons on error
                            linuxButton.disabled = false;
                            termuxButton.disabled = false;
                            windowsButton.disabled = false;
                        }
                    }
                );
            } else if (platformType === 'windows') {
                const downloadMessage = `Steghide cannot be installed directly via this web interface on Windows.
                <br><br>
                Please download it from the official Steghide website or a trusted package manager like Chocolatey:
                <br><br>
                Official Source (SourceForge): <a href="https://steghide.sourceforge.net/" target="_blank" class="text-blue-400 hover:underline">Steghide SourceForge</a>
                <br>
                Chocolatey (Package Manager): <a href="https://community.chocolatey.org/packages/steghide" target="_blank" class="text-blue-400 hover:underline">Chocolatey Steghide</a>
                <br><br>
                After installation, ensure 'steghide.exe' is in your system's PATH.`;
                showMessageModal('Install Steghide', downloadMessage, true); // Use isHtml = true
                showStatus('Steghide installation is not directly supported on Windows via this interface.', 'orange');
                // Re-enable buttons immediately for Windows as no backend process is started
                linuxButton.disabled = false;
                termuxButton.disabled = false;
                windowsButton.disabled = false;
            } else {
                showMessageModal('Install Steghide', `Steghide installation is not automatically supported for your operating system (${navigator.platform}). Please install Steghide manually.`);
                showStatus('Steghide installation is not supported for this system.', 'orange');
                // Re-enable buttons immediately for unsupported OS
                linuxButton.disabled = false;
                termuxButton.disabled = false;
                windowsButton.disabled = false;
            }
        }


        // Initial setup
        document.addEventListener('DOMContentLoaded', () => {
            clearAllInputs(); // Clear all inputs on page load to ensure no default values
            document.getElementById('command_text').value = 'steghide'; // Only display the command name
            loadExamples(); // Load examples for the Examples tab
            document.getElementById('run_steghide_button').addEventListener('click', runSteghide);
            document.getElementById('download_extracted_file_button').addEventListener('click', downloadExtractedFile);
            
            // New event listeners for specific installation buttons
            document.getElementById('install_steghide_linux_button').addEventListener('click', () => handleSteghideInstallation('linux'));
            document.getElementById('install_steghide_termux_button').addEventListener('click', () => handleSteghideInstallation('termux'));
            document.getElementById('install_steghide_windows_button').addEventListener('click', () => handleSteghideInstallation('windows'));
        });
    </script>
</body>
</html>
